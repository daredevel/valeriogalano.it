<!DOCTYPE html>
<html>

    <head>
        <title> Delete history of on your own SparkleShare server &middot; Valerio Galano - Software developer </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.62.0" />


<script src="/js/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>


<link rel="stylesheet" href="/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">


<link rel="stylesheet" href="https://valeriogalano.it/css/nix.css">



<link rel="shortcut icon" href="/img/favicon.ico">








<script type="text/javascript">
    var _iub = _iub || [];
    _iub.csConfiguration = {"lang":"it","siteId":110958,"consentOnLinkAndButton":false,"consentOnElement":null,"consentOnScroll":false,"cookiePolicyId":521121, "banner":{ "acceptButtonDisplay":true,"customizeButtonDisplay":true,"position":"float-top-center","acceptButtonColor":"#0073CE","acceptButtonCaptionColor":"white","customizeButtonColor":"#DADADA","customizeButtonCaptionColor":"#4D4D4D","textColor":"black","backgroundColor":"white" }};
    </script><script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script><meta property="og:title" content="Delete history of on your own SparkleShare server" />
<meta property="og:description" content="SparkleShareis a little Open Source software that allows users to share documents and files with version control and client side encryption system.
To put it simply, it acts like Dropbox or Ubuntu One, but it works on top of a Gitrepository. This means that, if you want, you can simply setup you own a SparkleShare server and share office documents with your colleagues having all infrastructure under your control using Git." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://valeriogalano.it/tutorials/delete-history-sparkleshare-server/" />
<meta property="og:image" content="https://valeriogalano.it/img/profile.jpg"/>
<meta property="article:published_time" content="2013-09-25T14:55:44+00:00" />
<meta property="article:modified_time" content="2013-09-25T14:55:44+00:00" /><meta property="og:site_name" content="Valerio Galano" />
<meta itemprop="name" content="Delete history of on your own SparkleShare server">
<meta itemprop="description" content="SparkleShareis a little Open Source software that allows users to share documents and files with version control and client side encryption system.
To put it simply, it acts like Dropbox or Ubuntu One, but it works on top of a Gitrepository. This means that, if you want, you can simply setup you own a SparkleShare server and share office documents with your colleagues having all infrastructure under your control using Git.">
<meta itemprop="datePublished" content="2013-09-25T14:55:44&#43;00:00" />
<meta itemprop="dateModified" content="2013-09-25T14:55:44&#43;00:00" />
<meta itemprop="wordCount" content="398">
<meta itemprop="image" content="https://valeriogalano.it/img/profile.jpg"/>



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://valeriogalano.it/img/profile.jpg"/>

<meta name="twitter:title" content="Delete history of on your own SparkleShare server"/>
<meta name="twitter:description" content="SparkleShareis a little Open Source software that allows users to share documents and files with version control and client side encryption system.
To put it simply, it acts like Dropbox or Ubuntu One, but it works on top of a Gitrepository. This means that, if you want, you can simply setup you own a SparkleShare server and share office documents with your colleagues having all infrastructure under your control using Git."/>


    </head>

    <body>
        <header>
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse font-header">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" id="green-terminal" href=https://valeriogalano.it/>valerio@daredevel ~ $</a>
		</div>

		
		<div class="collapse navbar-collapse" id="navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="https://valeriogalano.it/">/home/valerio</a>
				</li>
				
				
				<li class="dropdown">
                    
            		<a href="/post">~/blog</a>
            		
        		</li>
        		
				
				<li class="dropdown">
                    
            		<a href="https://pensieriincodice.it/">~/podcast</a>
            		
        		</li>
        		

			</ul>
		</div>
	</div>
</nav>
</header>

        <div class="container wrapper">
            <h1><a href="https://valeriogalano.it/tutorials/delete-history-sparkleshare-server/">Delete history of on your own SparkleShare server</a></h1>
            <span class="post-date">Sep 25, 2013 </span>
            <div class="post-content">
                <p><!-- raw HTML omitted -->SparkleShare<!-- raw HTML omitted --> is a little Open Source software that allows users to share documents and files with version control and client side encryption system.</p>
<p>To put it simply, it acts like Dropbox or Ubuntu One, but it works on top of a <!-- raw HTML omitted -->Git<!-- raw HTML omitted --> repository. This means that, if you want, you can simply setup you own a SparkleShare server and share office documents with your colleagues having all infrastructure under your control using Git.</p>
<p>This is exactly my office's approach and it works very well.</p>
<p>There's only an issue about this: sometimes you need to share big files for a limited period of time. Actually, SparkleShare (v 1.1) has no feature to clear history and this means that Git repositories contain all data needed to access to revisions. In simple words: each repository has disk size equal to the sum of each version of each file (also deleted).</p>
<p>In this case it could be useful to clear repository history in order to free a lot of disk space both on server and client.</p>
<p><!-- raw HTML omitted -->Please, keep in mind that following operations will delete all your SparkleShare history! Only actually shared file will be preserved!<!-- raw HTML omitted --></p>
<h2 id="lets-start-from-server">Let's start from server</h2>
<p>Open a terminal and reach git repository directory.</p>
<p>First of all, run following command to get actual directory size:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ du -sch</code></pre></div>
<p>Result should be bigger then actual size of shared files.</p>
<p>Now, let's run a command to clean all unnecessary files from repository:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ git gc --prune<span class="o">=</span>now --aggressive</code></pre></div>
<p>Output of this command should be something like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">Counting objects: 9, <span class="k">done</span>.
Delta compression using up to <span class="m">4</span> threads.
Compressing objects: 100% <span class="o">(</span>6/6<span class="o">)</span>, <span class="k">done</span>.
Writing objects: 100% <span class="o">(</span>9/9<span class="o">)</span>, <span class="k">done</span>.
Total <span class="m">9</span> <span class="o">(</span>delta 2<span class="o">)</span>, reused <span class="m">7</span> <span class="o">(</span>delta 0<span class="o">)</span></code></pre></div>
<p>At this point, we can repack repository objects by running:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ git repack -a -d -l</code></pre></div>
<p>Again, output of this command should be something like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">Counting objects: 9, <span class="k">done</span>.
Delta compression using up to <span class="m">4</span> threads.
Compressing objects: 100% <span class="o">(</span>4/4<span class="o">)</span>, <span class="k">done</span>.
Writing objects: 100% <span class="o">(</span>9/9<span class="o">)</span>, <span class="k">done</span>.
Total <span class="m">9</span> <span class="o">(</span>delta 2<span class="o">)</span>, reused <span class="m">9</span> <span class="o">(</span>delta 2<span class="o">)</span></code></pre></div>
<p>That's all. Let's check directory size again:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">$ du -sch</code></pre></div>
<p>Directory size should be smaller and very similar to actual shared file size.</p>
<h2 id="now-its-clients-turn">Now it's client's turn</h2>
<p>We should repeat operations shown above, for each client. In this way, we will free also client's disk space.</p>
<p><!-- raw HTML omitted -->Please note that, if we skip this step, no client's space will be released, even after synchronization.<!-- raw HTML omitted --></p>

            </div>
            
            <div class="post-comments">
                
<div id="disqus_thread"></div>
<script type="text/plain" class="_iub_cs_activate">

(function() {
    // Don't ever inject Disqus on localhost--it creates unwanted
    // discussions from 'localhost:1313' on your Disqus account...
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'daredevel';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

            </div>
            
            <div class="push"></div>
        </div>
        <footer class="footer text-center">
<p>Copyright &copy; 2019 Valerio Galano -
	<span class="credit">
	Powered by
	<a target="_blank" href="https://gohugo.io">Hugo</a>
	and
	<a target="_blank" href="https://github.com/LordMathis/hugo-theme-nix/">Nix</a> theme
</span> -
<a href="https://www.iubenda.com/privacy-policy/521121" class="iubenda-nostyle no-brand iubenda-embed" title="Privacy Policy ">Privacy Policy</a><script type="text/javascript">(function (w,d) {var loader = function () {var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0]; s.src="https://cdn.iubenda.com/iubenda.js"; tag.parentNode.insertBefore(s,tag);}; if(w.addEventListener){w.addEventListener("load", loader, false);}else if(w.attachEvent){w.attachEvent("onload", loader);}else{w.onload = loader;}})(window, document);</script>
</p>
</footer>

    </body>
